<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.78">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="A set of functions that I commonly use for building models">

<title>gh-pages-example - Model Utilities</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="gh-pages-example - Model Utilities">
<meta property="og:description" content="A set of functions that I commonly use for building models">
<meta property="og:site-name" content="gh-pages-example">
<meta name="twitter:title" content="gh-pages-example - Model Utilities">
<meta name="twitter:description" content="A set of functions that I commonly use for building models">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">gh-pages-example</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./blog/index.html" rel="" target="">
 <span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./blog/index.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/paolobova/gh-pages-example" rel="" target=""><i class="bi bi-github" role="img" aria-label="Github respository">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Model Utilities</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analytical_conditions.html" class="sidebar-item-text sidebar-link">Analytical conditions</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_utils.html" class="sidebar-item-text sidebar-link">Data utilities</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./methods.html" class="sidebar-item-text sidebar-link">Methods in Evolutionary Game Theory</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_utils.html" class="sidebar-item-text sidebar-link active">Model Utilities</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./plots_utils.html" class="sidebar-item-text sidebar-link">Plot utilities</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./types.html" class="sidebar-item-text sidebar-link">Types</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./utils.html" class="sidebar-item-text sidebar-link">Utilities</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">Methods</span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Payoffs/index.html" class="sidebar-item-text sidebar-link">Payoffs</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Payoffs/payoffs1.html" class="sidebar-item-text sidebar-link">Payoff Matrices (part 1)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Payoffs/payoffs2.html" class="sidebar-item-text sidebar-link">Payoff Matrices (part 2)</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./Analysis/index.html" class="sidebar-item-text sidebar-link">Analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Analysis/analysis_dsair.html" class="sidebar-item-text sidebar-link">Analysis of the DSAIR model</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#a-general-method-for-creating-model-data" id="toc-a-general-method-for-creating-model-data" class="nav-link active" data-scroll-target="#a-general-method-for-creating-model-data">A general method for creating model data</a>
  <ul>
  <li><a href="#model_builder" id="toc-model_builder" class="nav-link" data-scroll-target="#model_builder">model_builder</a></li>
  </ul></li>
  <li><a href="#efficiently-find-profiles-for-hypergeometric-sampling" id="toc-efficiently-find-profiles-for-hypergeometric-sampling" class="nav-link" data-scroll-target="#efficiently-find-profiles-for-hypergeometric-sampling">Efficiently find profiles for hypergeometric sampling</a>
  <ul>
  <li><a href="#find_unique_allocations" id="toc-find_unique_allocations" class="nav-link" data-scroll-target="#find_unique_allocations"><code>find_unique_allocations</code></a></li>
  <li><a href="#find_unique_allocations-1" id="toc-find_unique_allocations-1" class="nav-link" data-scroll-target="#find_unique_allocations-1">find_unique_allocations</a>
  <ul class="collapse">
  <li><a href="#tests-for-find_unique_allocations" id="toc-tests-for-find_unique_allocations" class="nav-link" data-scroll-target="#tests-for-find_unique_allocations">Tests for <code>find_unique_allocations</code></a></li>
  <li><a href="#tests-for-building-blocks-of-find_unique_counts" id="toc-tests-for-building-blocks-of-find_unique_counts" class="nav-link" data-scroll-target="#tests-for-building-blocks-of-find_unique_counts">Tests for building blocks of <code>find_unique_counts</code></a></li>
  </ul></li>
  <li><a href="#find_unique_counts" id="toc-find_unique_counts" class="nav-link" data-scroll-target="#find_unique_counts"><code>find_unique_counts</code></a></li>
  <li><a href="#find_unique_counts-1" id="toc-find_unique_counts-1" class="nav-link" data-scroll-target="#find_unique_counts-1">find_unique_counts</a>
  <ul class="collapse">
  <li><a href="#tests-for-find_unique_counts" id="toc-tests-for-find_unique_counts" class="nav-link" data-scroll-target="#tests-for-find_unique_counts">Tests for <code>find_unique_counts</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#methods-for-creating-strategy-profile-codes-for-a-set-of-models." id="toc-methods-for-creating-strategy-profile-codes-for-a-set-of-models." class="nav-link" data-scroll-target="#methods-for-creating-strategy-profile-codes-for-a-set-of-models.">Methods for creating strategy profile codes for a set of models.</a>
  <ul>
  <li><a href="#multi.._inner" id="toc-multi.._inner" class="nav-link" data-scroll-target="#multi.._inner">multi.<locals>._inner</locals></a></li>
  <li><a href="#multi.._inner-1" id="toc-multi.._inner-1" class="nav-link" data-scroll-target="#multi.._inner-1">multi.<locals>._inner</locals></a></li>
  <li><a href="#multi.._inner-2" id="toc-multi.._inner-2" class="nav-link" data-scroll-target="#multi.._inner-2">multi.<locals>._inner</locals></a></li>
  <li><a href="#multi.._inner-3" id="toc-multi.._inner-3" class="nav-link" data-scroll-target="#multi.._inner-3">multi.<locals>._inner</locals></a></li>
  </ul></li>
  <li><a href="#profile-filters" id="toc-profile-filters" class="nav-link" data-scroll-target="#profile-filters">Profile filters</a>
  <ul>
  <li><a href="#multi.._inner-4" id="toc-multi.._inner-4" class="nav-link" data-scroll-target="#multi.._inner-4">multi.<locals>._inner</locals></a></li>
  <li><a href="#multi.._inner-5" id="toc-multi.._inner-5" class="nav-link" data-scroll-target="#multi.._inner-5">multi.<locals>._inner</locals></a></li>
  <li><a href="#multi.._inner-6" id="toc-multi.._inner-6" class="nav-link" data-scroll-target="#multi.._inner-6">multi.<locals>._inner</locals></a></li>
  <li><a href="#multi.._inner-7" id="toc-multi.._inner-7" class="nav-link" data-scroll-target="#multi.._inner-7">multi.<locals>._inner</locals></a></li>
  <li><a href="#apply_profile_filters" id="toc-apply_profile_filters" class="nav-link" data-scroll-target="#apply_profile_filters">apply_profile_filters</a></li>
  <li><a href="#an-additional-method-for-create_profiles-which-depends-on-profile_filter" id="toc-an-additional-method-for-create_profiles-which-depends-on-profile_filter" class="nav-link" data-scroll-target="#an-additional-method-for-create_profiles-which-depends-on-profile_filter">An additional method for <code>create_profiles</code> which depends on <code>profile_filter</code></a></li>
  <li><a href="#multi.._inner-8" id="toc-multi.._inner-8" class="nav-link" data-scroll-target="#multi.._inner-8">multi.<locals>._inner</locals></a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/PaoloBova/gh-pages-example/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Model Utilities</h1>
</div>

<div>
  <div class="description">
    A set of functions that I commonly use for building models
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="a-general-method-for-creating-model-data" class="level2">
<h2 class="anchored" data-anchor-id="a-general-method-for-creating-model-data">A general method for creating model data</h2>
<hr>
<p><a href="https://github.com/PaoloBova/gh-pages-example/blob/main/gh_pages_example/model_utils.py#L25" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="model_builder" class="level3">
<h3 class="anchored" data-anchor-id="model_builder">model_builder</h3>
<blockquote class="blockquote">
<pre><code> model_builder (saved_args:dict, exclude_args:list[str]=[],
                override:bool=False, drop_args:list[str]=['override',
                'exclude_args', 'drop_args'])</code></pre>
</blockquote>
<p>Build models for all combinations of the valules in <code>saved_args</code>.</p>
<table class="table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>saved_args</td>
<td>dict</td>
<td></td>
<td>a dictionary containing parameters we want to vary or hold fixed</td>
</tr>
<tr class="even">
<td>exclude_args</td>
<td>list</td>
<td>[]</td>
<td>a list of arguments that should be returned as they are</td>
</tr>
<tr class="odd">
<td>override</td>
<td>bool</td>
<td>False</td>
<td>whether to build the grid if it is very large</td>
</tr>
<tr class="even">
<td>drop_args</td>
<td>list</td>
<td>[‘override’, ‘exclude_args’, ‘drop_args’]</td>
<td>a list of arguments to drop from the final result</td>
</tr>
<tr class="odd">
<td><strong>Returns</strong></td>
<td><strong>dict</strong></td>
<td></td>
<td><strong>A dictionary containing items for the desired models</strong></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="efficiently-find-profiles-for-hypergeometric-sampling" class="level2">
<h2 class="anchored" data-anchor-id="efficiently-find-profiles-for-hypergeometric-sampling">Efficiently find profiles for hypergeometric sampling</h2>
<section id="find_unique_allocations" class="level3">
<h3 class="anchored" data-anchor-id="find_unique_allocations"><a href="https://PaoloBova.github.io/gh-pages-example/model_utils.html#find_unique_allocations"><code>find_unique_allocations</code></a></h3>
<p>We want to lexicographically sort our 2D array as we want to sort them so that those thoses with the highest counts for the lowest strategies (according to their numerical code) for the earliest subgroups considered (players are split into subgroups based on their allowed sectors, and subgroups are ordered by their lowest player index).</p>
<p>We can achieve this if we have strategy counts for each subgroup in a list, with counts for earlier subgroups first. We then build a list of these lists, one list for each possible way of achieving the same combined strategy count if we added each strategy count for each subgroup together.</p>
<p>So, I test that we can correctly convert a list of list of arrays to our desired 2D array.</p>
<p>We then perform our lexicographic sort and take only the last row of the sorted array. This is the combination of strategy counts which satisfies the properties we specified above.</p>
<hr>
<p><a href="https://github.com/PaoloBova/gh-pages-example/blob/main/gh_pages_example/model_utils.py#L61" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="find_unique_allocations-1" class="level3">
<h3 class="anchored" data-anchor-id="find_unique_allocations-1">find_unique_allocations</h3>
<blockquote class="blockquote">
<pre><code> find_unique_allocations (n, k)</code></pre>
</blockquote>
<p>Find all combinations with replacement of ‘n’ of the first <code>k</code> integers where the sum of the integers is <code>k</code>.</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>n</td>
<td>The number of items to allocate</td>
</tr>
<tr class="even">
<td>k</td>
<td>The number of bins that items can be allocated to</td>
</tr>
</tbody>
</table>
<section id="tests-for-find_unique_allocations" class="level4">
<h4 class="anchored" data-anchor-id="tests-for-find_unique_allocations">Tests for <a href="https://PaoloBova.github.io/gh-pages-example/model_utils.html#find_unique_allocations"><code>find_unique_allocations</code></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(find_unique_allocations(<span class="dv">2</span>, <span class="dv">4</span>),</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                      [[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>],</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>],</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], ])</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(find_unique_allocations(<span class="dv">4</span>, <span class="dv">3</span>),</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                      [[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>],</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>],</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>],</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>],</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>],</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>],</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>],</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>],</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>],</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>], ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tests-for-building-blocks-of-find_unique_counts" class="level4">
<h4 class="anchored" data-anchor-id="tests-for-building-blocks-of-find_unique_counts">Tests for building blocks of <a href="https://PaoloBova.github.io/gh-pages-example/model_utils.html#find_unique_counts"><code>find_unique_counts</code></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>current_sub_group <span class="op">=</span> [[<span class="st">"2"</span>, <span class="st">"3"</span>], <span class="dv">2</span>]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>count_groups <span class="op">=</span> [[[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>], [[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]]],</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                [[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]]],</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>categories, n_draws <span class="op">=</span> current_sub_group</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>n_categories <span class="op">=</span> <span class="bu">len</span>(categories)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> find_unique_allocations(n_draws, n_categories)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>n_all_categories <span class="op">=</span> <span class="bu">len</span>(count_groups[<span class="dv">0</span>][<span class="dv">0</span>])</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>allocations <span class="op">=</span> np.zeros((<span class="bu">len</span>(counts), n_all_categories))</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> category, count <span class="kw">in</span> <span class="bu">zip</span>(categories, np.array(counts).T):</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    allocations[:, <span class="bu">int</span>(category)] <span class="op">=</span> count</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(allocations,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                      [[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>],</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>], ])</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>current_sub_group <span class="op">=</span> [[<span class="st">"1"</span>, <span class="st">"3"</span>], <span class="dv">2</span>]</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>count_groups <span class="op">=</span> [[[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>], [[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]]],</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>                [[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]]],</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>categories, n_draws <span class="op">=</span> current_sub_group</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>n_categories <span class="op">=</span> <span class="bu">len</span>(categories)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>counts <span class="op">=</span> find_unique_allocations(n_draws, n_categories)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>n_all_categories <span class="op">=</span> <span class="bu">len</span>(count_groups[<span class="dv">0</span>][<span class="dv">0</span>])</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>allocations <span class="op">=</span> np.zeros((<span class="bu">len</span>(counts), n_all_categories))</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> category, count <span class="kw">in</span> <span class="bu">zip</span>(categories, np.array(counts).T):</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    allocations[:, <span class="bu">int</span>(category)] <span class="op">=</span> count</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(allocations,</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>                      [[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>],</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>                       [<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>], ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(np.<span class="bu">sum</span>([[<span class="dv">1</span>, <span class="dv">1</span>], np.array([<span class="dv">1</span>, <span class="dv">2</span>])], axis<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                      [<span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(<span class="st">":"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, <span class="bu">map</span>(<span class="bu">int</span>, [<span class="dv">1</span>, <span class="dv">2</span>, <span class="fl">3.0</span>]))),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"1:2:3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>repeated_counts <span class="op">=</span> [[np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]),</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                    np.array([<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]), ],</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                   [np.array([<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                    np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]), ]]</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.vstack([np.hstack(seq) <span class="cf">for</span> seq <span class="kw">in</span> repeated_counts])</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(y,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                      np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>                                [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]]))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(np.lexsort(y.T[::<span class="op">-</span><span class="dv">1</span>]),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>                      [<span class="dv">0</span>, <span class="dv">1</span>])</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(np.lexsort(y.T[::<span class="op">-</span><span class="dv">1</span>])[<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>                      <span class="dv">1</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(y[np.lexsort(y.T[::<span class="op">-</span><span class="dv">1</span>])[<span class="op">-</span><span class="dv">1</span>]],</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>                      [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(np.split(y[np.lexsort(y.T[::<span class="op">-</span><span class="dv">1</span>])[<span class="op">-</span><span class="dv">1</span>]], <span class="dv">2</span>),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                      [[<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="find_unique_counts" class="level3">
<h3 class="anchored" data-anchor-id="find_unique_counts"><a href="https://PaoloBova.github.io/gh-pages-example/model_utils.html#find_unique_counts"><code>find_unique_counts</code></a></h3>
<hr>
<p><a href="https://github.com/PaoloBova/gh-pages-example/blob/main/gh_pages_example/model_utils.py#L72" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="find_unique_counts-1" class="level3">
<h3 class="anchored" data-anchor-id="find_unique_counts-1">find_unique_counts</h3>
<blockquote class="blockquote">
<pre><code> find_unique_counts (count_groups, current_sub_group)</code></pre>
</blockquote>
<p>Build a list of all unique count groups given an allocation and a list of existing unique counts.</p>
<section id="tests-for-find_unique_counts" class="level4">
<h4 class="anchored" data-anchor-id="tests-for-find_unique_counts">Tests for <a href="https://PaoloBova.github.io/gh-pages-example/model_utils.html#find_unique_counts"><code>find_unique_counts</code></a></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>current_sub_group <span class="op">=</span> [[<span class="st">"2"</span>, <span class="st">"3"</span>], <span class="dv">2</span>]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>count_groups <span class="op">=</span> [[[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]], ]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_unique_counts(count_groups, current_sub_group)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>expected <span class="op">=</span> [[[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>]],</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>            [[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>]],</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>            [[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>]]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>current_sub_group <span class="op">=</span> [[<span class="st">"2"</span>, <span class="st">"3"</span>], <span class="dv">2</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>count_groups <span class="op">=</span> [[[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]], ]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_unique_counts(count_groups, current_sub_group)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>expected <span class="op">=</span> [[[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>]],</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>            [[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>]],</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>            [[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>]]]</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>current_sub_group <span class="op">=</span> [[<span class="st">"2"</span>, <span class="st">"3"</span>], <span class="dv">2</span>]</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice that the given count groups are redundant since if we had created them</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># using `find_unique_counts`, then we would have only kept the bottom one.</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>count_groups <span class="op">=</span> [[[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]],</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                [[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]],</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                ]</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_unique_counts(count_groups, current_sub_group)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>expected <span class="op">=</span> [[[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>]],</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>            [[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>]],</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>            [[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>]]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>allowed_sectors <span class="op">=</span> {<span class="st">"P1"</span>: [<span class="st">"S1"</span>],</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"P2"</span>: [<span class="st">"S1"</span>, <span class="st">"S2"</span>], }</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>sector_strategies <span class="op">=</span> {<span class="st">"S1"</span>: [<span class="st">"1"</span>, <span class="st">"2"</span>],</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"S2"</span>: [<span class="st">"3"</span>, <span class="st">"4"</span>],</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"S3"</span>: [<span class="st">"5"</span>, <span class="st">"6"</span>]}</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>rules <span class="op">=</span> collections.defaultdict(<span class="bu">list</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> player, sectors <span class="kw">in</span> allowed_sectors.items():</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    available_strategies <span class="op">=</span> []</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sector <span class="kw">in</span> sectors:</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>        available_strategies <span class="op">+=</span> sector_strategies[sector]</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    available_strategies <span class="op">=</span> np.unique(available_strategies)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    rule <span class="op">=</span> <span class="st">":"</span>.join(available_strategies)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    rules[rule].append(player)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>subgroups <span class="op">=</span> [[<span class="bu">str</span>.split(rule, <span class="st">':'</span>), <span class="bu">len</span>(players)]</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>             <span class="cf">for</span> rule, players <span class="kw">in</span> rules.items()]</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(subgroups,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>                      [[[<span class="st">'1'</span>, <span class="st">'2'</span>], <span class="dv">1</span>], [[<span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>, <span class="st">'4'</span>], <span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">sorted</span>([<span class="st">"P10"</span>, <span class="st">"P1"</span>,<span class="st">"P2"</span>])</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>player_strings <span class="op">=</span> [<span class="st">"P10"</span>, <span class="st">"P1"</span>,<span class="st">"P2"</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>player_numbers <span class="op">=</span> [<span class="bu">int</span>(<span class="st">""</span>.join(string[<span class="dv">1</span>:]))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">for</span> string <span class="kw">in</span> player_strings]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>players <span class="op">=</span> [<span class="ss">f"P</span><span class="sc">{</span>x<span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">sorted</span>(player_numbers)]</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(players, [<span class="st">"P1"</span>, <span class="st">"P2"</span>,<span class="st">"P10"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="methods-for-creating-strategy-profile-codes-for-a-set-of-models." class="level2">
<h2 class="anchored" data-anchor-id="methods-for-creating-strategy-profile-codes-for-a-set-of-models.">Methods for creating strategy profile codes for a set of models.</h2>
<p>I also need a method for creating all possible player profiles. I need to use this method before the profile filters can do any filtering.</p>
<p>We can also apply our profile filters to this list to know exactly which profiles we need to write payoffs for.</p>
<p>I also use this method to validate that we have passed sufficient information to payoffs, and to warn us about what is missing.</p>
<p>Note that it creates strategy profiles where some players may not be present (as represented by the strategy <code>0</code>). It is useful to think of <code>0</code> as representing a “null sector” as it captures the possibility that a player isn’t sampled from any of the sectors.</p>
<p>If one instead wants to capture the possibility that particular sectors may be less likely to participate, they may achieve this by creating a new strategy for that sector to represent a member from that sector as not participating in the interaction. It is also possible to achieve a similar effect by using <code>sector_weights</code>.</p>
<p>I prefer to reserve <code>0</code> as a code for a missing player, so I index strategies from <code>1</code>. However, note that if you wish to index your strategies from <code>0</code> instead, the profile filters are flexible enough to allow you to do so without issue. If you wish to later add the possibility of missing players, you just need to assign it a new code which you use to indicate the relevant payoffs.</p>
<hr>
<section id="multi.._inner" class="level3">
<h3 class="anchored" data-anchor-id="multi.._inner">multi.<locals>._inner</locals></h3>
<blockquote class="blockquote">
<pre><code> multi.&lt;locals&gt;._inner (*args, **kwargs)</code></pre>
</blockquote>
<hr>
</section>
<section id="multi.._inner-1" class="level3">
<h3 class="anchored" data-anchor-id="multi.._inner-1">multi.<locals>._inner</locals></h3>
<blockquote class="blockquote">
<pre><code> multi.&lt;locals&gt;._inner (*args, **kwargs)</code></pre>
</blockquote>
<hr>
</section>
<section id="multi.._inner-2" class="level3">
<h3 class="anchored" data-anchor-id="multi.._inner-2">multi.<locals>._inner</locals></h3>
<blockquote class="blockquote">
<pre><code> multi.&lt;locals&gt;._inner (*args, **kwargs)</code></pre>
</blockquote>
<hr>
</section>
<section id="multi.._inner-3" class="level3">
<h3 class="anchored" data-anchor-id="multi.._inner-3">multi.<locals>._inner</locals></h3>
<blockquote class="blockquote">
<pre><code> multi.&lt;locals&gt;._inner (*args, **kwargs)</code></pre>
</blockquote>
<section id="tests-for-create_profiles" class="level5">
<h5 class="anchored" data-anchor-id="tests-for-create_profiles">Tests for <a href="https://PaoloBova.github.io/gh-pages-example/model_utils.html#create_profiles"><code>create_profiles</code></a></h5>
<p>Here are tests for the default method, where all possible profiles are created for a given number of strategies and players.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> create_profiles({<span class="st">"n_players"</span>: <span class="dv">2</span>, <span class="st">"n_strategies"</span>: <span class="dv">2</span>})</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(result[<span class="st">'profiles'</span>],</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                      [<span class="st">'0-0'</span>, <span class="st">'0-1'</span>, <span class="st">'0-2'</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">'1-0'</span>, <span class="st">'1-1'</span>, <span class="st">'1-2'</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">'2-0'</span>, <span class="st">'2-1'</span>, <span class="st">'2-2'</span>])</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> create_profiles({<span class="st">"n_players"</span>: <span class="dv">2</span>, <span class="st">"n_strategies"</span>: [<span class="dv">2</span>, <span class="dv">1</span>]})</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(result[<span class="st">'profiles'</span>],</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                      [<span class="st">"0-0"</span>, <span class="st">"0-1"</span>, <span class="st">"0-2"</span>, <span class="st">"0-3"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"1-0"</span>, <span class="st">"1-1"</span>, <span class="st">"1-2"</span>, <span class="st">"1-3"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"2-0"</span>, <span class="st">"2-1"</span>, <span class="st">"2-2"</span>, <span class="st">"2-3"</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"3-0"</span>, <span class="st">"3-1"</span>, <span class="st">"3-2"</span>, <span class="st">"3-3"</span>, ])</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(create_profiles({<span class="st">"n_players"</span>: <span class="dv">2</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"n_strategies"</span>: [<span class="dv">2</span>, <span class="dv">2</span>]})[<span class="st">'profiles'</span>],</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                      create_profiles({<span class="st">"n_players"</span>: <span class="dv">2</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"n_strategies"</span>: <span class="dv">4</span>})[<span class="st">'profiles'</span>])</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {<span class="st">"allowed_sectors"</span>: {<span class="st">"P1"</span>: [<span class="st">"S1"</span>],</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"P2"</span>: [<span class="st">"S2"</span>]},</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>          <span class="st">"sector_strategies"</span>: {<span class="st">"S1"</span>: [<span class="dv">1</span>, <span class="dv">2</span>],</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"S2"</span>: [<span class="dv">3</span>, <span class="dv">4</span>]}}</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(create_profiles(models)[<span class="st">'profiles'</span>],</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>                      create_profiles({<span class="st">"n_players"</span>: <span class="dv">2</span>,</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"n_strategies"</span>: <span class="dv">4</span>})[<span class="st">'profiles'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I’ll test the <code>"from_strategy_count"</code> method. Notice that it grows quickly for larger strategy counts with more choices. As a rule of thumb, this will become untenable with more than 10 players, especially when there are more choices to choose between.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>strategy_count <span class="op">=</span> {<span class="st">"1"</span>: <span class="dv">2</span>, <span class="st">"2"</span>: <span class="dv">2</span>}</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {<span class="st">"strategy_count"</span>: strategy_count,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"profiles_rule"</span>: <span class="st">"from_strategy_count"</span>}</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> create_profiles(models)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> (math.factorial(<span class="bu">sum</span>(strategy_count.values()))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>          <span class="op">/</span> math.prod([math.factorial(v) <span class="cf">for</span> v <span class="kw">in</span> strategy_count.values()]))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(length, <span class="bu">len</span>(results[<span class="st">'profiles'</span>]))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>expected <span class="op">=</span> [<span class="st">"1-1-2-2"</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"1-2-1-2"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">"1-2-2-1"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"2-1-1-2"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"2-1-2-1"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"2-2-1-1"</span>,]</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(expected, results[<span class="st">'profiles'</span>])</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>strategy_count <span class="op">=</span> {<span class="st">"1"</span>: <span class="dv">2</span>, <span class="st">"2"</span>: <span class="dv">2</span>, <span class="st">"3"</span>: <span class="dv">4</span>, <span class="st">"4"</span>: <span class="dv">3</span>}</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {<span class="st">"strategy_count"</span>: strategy_count,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>          <span class="st">"profiles_rule"</span>: <span class="st">"from_strategy_count"</span>}</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> create_profiles(models)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>length <span class="op">=</span> (math.factorial(<span class="bu">sum</span>(strategy_count.values()))</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>          <span class="op">/</span> math.prod([math.factorial(v) <span class="cf">for</span> v <span class="kw">in</span> strategy_count.values()]))</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(length, <span class="bu">len</span>(results[<span class="st">'profiles'</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We also include tests for the <a href="https://PaoloBova.github.io/gh-pages-example/model_utils.html#create_profiles"><code>create_profiles</code></a> “anonymous” method. which only creates one profile for each unique count of strategies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>allowed_sectors <span class="op">=</span> {<span class="st">"P1"</span>: [<span class="st">"S1"</span>],</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"P2"</span>: [<span class="st">"S1"</span>, <span class="st">"S2"</span>], }</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Third sector irrelevant given allowed sectors</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>sector_strategies <span class="op">=</span> {<span class="st">"S1"</span>: [<span class="st">"1"</span>, <span class="st">"2"</span>],</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"S2"</span>: [<span class="st">"3"</span>, <span class="st">"4"</span>],</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"S3"</span>: [<span class="st">"5"</span>, <span class="st">"6"</span>]}</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {<span class="st">"allowed_sectors"</span>: allowed_sectors,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"sector_strategies"</span>: sector_strategies,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"profiles_rule"</span>: <span class="st">"anonymous"</span>, }</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>profiles <span class="op">=</span> create_profiles(models)[<span class="st">'profiles'</span>]</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>expected <span class="op">=</span> [<span class="st">'4-2'</span>, <span class="st">'3-2'</span>, <span class="st">'2-2'</span>, <span class="st">'2-1'</span>, <span class="st">'4-1'</span>, <span class="st">'3-1'</span>, <span class="st">'1-1'</span>]</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(profiles, expected)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(<span class="bu">sorted</span>(profiles),</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                      [<span class="st">'1-1'</span>, <span class="st">'2-1'</span>, <span class="st">'2-2'</span>, <span class="st">'3-1'</span>, <span class="st">'3-2'</span>, <span class="st">'4-1'</span>, <span class="st">'4-2'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>allowed_sectors <span class="op">=</span> {<span class="st">"P1"</span>: [<span class="st">"S1"</span>],</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"P2"</span>: [<span class="st">"S1"</span>, <span class="st">"S2"</span>], }</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Third sector irrelevant given allowed sectors</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>sector_strategies <span class="op">=</span> {<span class="st">"S1"</span>: [<span class="st">"1"</span>, <span class="st">"0"</span>],</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"S2"</span>: [<span class="st">"3"</span>, <span class="st">"4"</span>],</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"S3"</span>: [<span class="st">"5"</span>, <span class="st">"6"</span>]}</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {<span class="st">"allowed_sectors"</span>: allowed_sectors,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"sector_strategies"</span>: sector_strategies,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"profiles_rule"</span>: <span class="st">"anonymous"</span>, }</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>profiles <span class="op">=</span> create_profiles(models)[<span class="st">'profiles'</span>]</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>expected <span class="op">=</span> [<span class="st">'4-1'</span>, <span class="st">'3-1'</span>, <span class="st">'1-1'</span>, <span class="st">'1-0'</span>, <span class="st">'4-0'</span>, <span class="st">'3-0'</span>, <span class="st">'0-0'</span>]</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(profiles, expected)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(<span class="bu">sorted</span>(profiles),</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>                      [<span class="st">'0-0'</span>, <span class="st">'1-0'</span>, <span class="st">'1-1'</span>, <span class="st">'3-0'</span>, <span class="st">'3-1'</span>, <span class="st">'4-0'</span>, <span class="st">'4-1'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>allowed_sectors <span class="op">=</span> {<span class="st">"P1"</span>: [<span class="st">"S1"</span>],</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"P2"</span>: [<span class="st">"S1"</span>, <span class="st">"S2"</span>],</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"P3"</span>: [<span class="st">"S1"</span>, <span class="st">"S2"</span>],</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"P4"</span>: [<span class="st">"S1"</span>, <span class="st">"S2"</span>],</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"P5"</span>: [<span class="st">"S1"</span>, <span class="st">"S2"</span>],</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"P6"</span>: [<span class="st">"S1"</span>, <span class="st">"S2"</span>],</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"P7"</span>: [<span class="st">"S1"</span>, <span class="st">"S2"</span>],</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"P8"</span>: [<span class="st">"S1"</span>, <span class="st">"S2"</span>],</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"P9"</span>: [<span class="st">"S1"</span>, <span class="st">"S2"</span>],</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"P10"</span>: [<span class="st">"S1"</span>, <span class="st">"S2"</span>], }</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Third sector irrelevant given allowed sectors</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>sector_strategies <span class="op">=</span> {<span class="st">"S1"</span>: [<span class="st">"1"</span>, <span class="st">"2"</span>],</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"S2"</span>: [<span class="st">"3"</span>, <span class="st">"4"</span>],</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"S3"</span>: [<span class="st">"5"</span>, <span class="st">"6"</span>]}</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {<span class="st">"allowed_sectors"</span>: allowed_sectors,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">"sector_strategies"</span>: sector_strategies,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>          <span class="st">"profiles_rule"</span>: <span class="st">"anonymous"</span>, }</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>profiles <span class="op">=</span> create_profiles(models)[<span class="st">'profiles'</span>]</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>expected <span class="op">=</span> [<span class="st">'1-1-1-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">'2-1-1-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">'2-2-1-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">'2-2-2-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">'2-2-2-2-1-1-1-1-1-1'</span>,</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">'2-2-2-2-2-1-1-1-1-1'</span>,</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">'2-2-2-2-2-2-1-1-1-1'</span>,</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">'2-2-2-2-2-2-2-1-1-1'</span>,</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">'2-2-2-2-2-2-2-2-1-1'</span>,</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>            <span class="st">'2-2-2-2-2-2-2-2-2-1'</span>,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>            <span class="st">'2-2-2-2-2-2-2-2-2-2'</span>,</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-1-1-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-2-1-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-2-2-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-2-2-2-1-1-1-1-1-1'</span>,</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-2-2-2-2-1-1-1-1-1'</span>,</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-2-2-2-2-2-1-1-1-1'</span>,</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-2-2-2-2-2-2-1-1-1'</span>,</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-2-2-2-2-2-2-2-1-1'</span>,</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-2-2-2-2-2-2-2-2-1'</span>,</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-2-2-2-2-2-2-2-2-2'</span>,</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-1-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-2-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-2-2-1-1-1-1-1-1'</span>,</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-2-2-2-1-1-1-1-1'</span>,</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-2-2-2-2-1-1-1-1'</span>,</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-2-2-2-2-2-1-1-1'</span>,</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-2-2-2-2-2-2-1-1'</span>,</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-2-2-2-2-2-2-2-1'</span>,</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-2-2-2-2-2-2-2-2'</span>,</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-2-1-1-1-1-1-1'</span>,</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-2-2-1-1-1-1-1'</span>,</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-2-2-2-1-1-1-1'</span>,</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-2-2-2-2-1-1-1'</span>,</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-2-2-2-2-2-1-1'</span>,</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-2-2-2-2-2-2-1'</span>,</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-2-2-2-2-2-2-2'</span>,</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-1-1-1-1-1-1'</span>,</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-2-1-1-1-1-1'</span>,</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-2-2-1-1-1-1'</span>,</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-2-2-2-1-1-1'</span>,</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-2-2-2-2-1-1'</span>,</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-2-2-2-2-2-1'</span>,</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-2-2-2-2-2-2'</span>,</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-1-1-1-1-1'</span>,</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-2-1-1-1-1'</span>,</span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-2-2-1-1-1'</span>,</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-2-2-2-1-1'</span>,</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-2-2-2-2-1'</span>,</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-2-2-2-2-2'</span>,</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-1-1-1-1'</span>,</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-2-1-1-1'</span>,</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-2-2-1-1'</span>,</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-2-2-2-1'</span>,</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-2-2-2-2'</span>,</span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-3-1-1-1'</span>,</span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-3-2-1-1'</span>,</span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-3-2-2-1'</span>,</span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-3-2-2-2'</span>,</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-3-3-1-1'</span>,</span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-3-3-2-1'</span>,</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-3-3-2-2'</span>,</span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-3-3-3-1'</span>,</span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a>            <span class="st">'3-3-3-3-3-3-3-3-3-2'</span>,</span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-1-1-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-2-1-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-2-2-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-2-2-2-1-1-1-1-1-1'</span>,</span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-2-2-2-2-1-1-1-1-1'</span>,</span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-2-2-2-2-2-1-1-1-1'</span>,</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-2-2-2-2-2-2-1-1-1'</span>,</span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-2-2-2-2-2-2-2-1-1'</span>,</span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-2-2-2-2-2-2-2-2-1'</span>,</span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-2-2-2-2-2-2-2-2-2'</span>,</span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-1-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-2-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-2-2-1-1-1-1-1-1'</span>,</span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-2-2-2-1-1-1-1-1'</span>,</span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-2-2-2-2-1-1-1-1'</span>,</span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-2-2-2-2-2-1-1-1'</span>,</span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-2-2-2-2-2-2-1-1'</span>,</span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-2-2-2-2-2-2-2-1'</span>,</span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-2-2-2-2-2-2-2-2'</span>,</span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-2-1-1-1-1-1-1'</span>,</span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-2-2-1-1-1-1-1'</span>,</span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-2-2-2-1-1-1-1'</span>,</span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-2-2-2-2-1-1-1'</span>,</span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-2-2-2-2-2-1-1'</span>,</span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-2-2-2-2-2-2-1'</span>,</span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-2-2-2-2-2-2-2'</span>,</span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-1-1-1-1-1-1'</span>,</span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-2-1-1-1-1-1'</span>,</span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-2-2-1-1-1-1'</span>,</span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-2-2-2-1-1-1'</span>,</span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-2-2-2-2-1-1'</span>,</span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-2-2-2-2-2-1'</span>,</span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-2-2-2-2-2-2'</span>,</span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-1-1-1-1-1'</span>,</span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-2-1-1-1-1'</span>,</span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-2-2-1-1-1'</span>,</span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-2-2-2-1-1'</span>,</span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-2-2-2-2-1'</span>,</span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-2-2-2-2-2'</span>,</span>
<span id="cb20-124"><a href="#cb20-124" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-1-1-1-1'</span>,</span>
<span id="cb20-125"><a href="#cb20-125" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-2-1-1-1'</span>,</span>
<span id="cb20-126"><a href="#cb20-126" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-2-2-1-1'</span>,</span>
<span id="cb20-127"><a href="#cb20-127" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-2-2-2-1'</span>,</span>
<span id="cb20-128"><a href="#cb20-128" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-2-2-2-2'</span>,</span>
<span id="cb20-129"><a href="#cb20-129" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-3-1-1-1'</span>,</span>
<span id="cb20-130"><a href="#cb20-130" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-3-2-1-1'</span>,</span>
<span id="cb20-131"><a href="#cb20-131" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-3-2-2-1'</span>,</span>
<span id="cb20-132"><a href="#cb20-132" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-3-2-2-2'</span>,</span>
<span id="cb20-133"><a href="#cb20-133" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-3-3-1-1'</span>,</span>
<span id="cb20-134"><a href="#cb20-134" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-3-3-2-1'</span>,</span>
<span id="cb20-135"><a href="#cb20-135" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-3-3-2-2'</span>,</span>
<span id="cb20-136"><a href="#cb20-136" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-3-3-3-1'</span>,</span>
<span id="cb20-137"><a href="#cb20-137" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-3-3-3-3-3-3-3-3-2'</span>,</span>
<span id="cb20-138"><a href="#cb20-138" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-1-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-139"><a href="#cb20-139" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-2-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-140"><a href="#cb20-140" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-2-2-1-1-1-1-1-1'</span>,</span>
<span id="cb20-141"><a href="#cb20-141" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-2-2-2-1-1-1-1-1'</span>,</span>
<span id="cb20-142"><a href="#cb20-142" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-2-2-2-2-1-1-1-1'</span>,</span>
<span id="cb20-143"><a href="#cb20-143" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-2-2-2-2-2-1-1-1'</span>,</span>
<span id="cb20-144"><a href="#cb20-144" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-2-2-2-2-2-2-1-1'</span>,</span>
<span id="cb20-145"><a href="#cb20-145" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-2-2-2-2-2-2-2-1'</span>,</span>
<span id="cb20-146"><a href="#cb20-146" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-2-2-2-2-2-2-2-2'</span>,</span>
<span id="cb20-147"><a href="#cb20-147" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-148"><a href="#cb20-148" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-2-1-1-1-1-1-1'</span>,</span>
<span id="cb20-149"><a href="#cb20-149" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-2-2-1-1-1-1-1'</span>,</span>
<span id="cb20-150"><a href="#cb20-150" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-2-2-2-1-1-1-1'</span>,</span>
<span id="cb20-151"><a href="#cb20-151" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-2-2-2-2-1-1-1'</span>,</span>
<span id="cb20-152"><a href="#cb20-152" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-2-2-2-2-2-1-1'</span>,</span>
<span id="cb20-153"><a href="#cb20-153" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-2-2-2-2-2-2-1'</span>,</span>
<span id="cb20-154"><a href="#cb20-154" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-2-2-2-2-2-2-2'</span>,</span>
<span id="cb20-155"><a href="#cb20-155" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-1-1-1-1-1-1'</span>,</span>
<span id="cb20-156"><a href="#cb20-156" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-2-1-1-1-1-1'</span>,</span>
<span id="cb20-157"><a href="#cb20-157" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-2-2-1-1-1-1'</span>,</span>
<span id="cb20-158"><a href="#cb20-158" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-2-2-2-1-1-1'</span>,</span>
<span id="cb20-159"><a href="#cb20-159" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-2-2-2-2-1-1'</span>,</span>
<span id="cb20-160"><a href="#cb20-160" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-2-2-2-2-2-1'</span>,</span>
<span id="cb20-161"><a href="#cb20-161" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-2-2-2-2-2-2'</span>,</span>
<span id="cb20-162"><a href="#cb20-162" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-1-1-1-1-1'</span>,</span>
<span id="cb20-163"><a href="#cb20-163" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-2-1-1-1-1'</span>,</span>
<span id="cb20-164"><a href="#cb20-164" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-2-2-1-1-1'</span>,</span>
<span id="cb20-165"><a href="#cb20-165" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-2-2-2-1-1'</span>,</span>
<span id="cb20-166"><a href="#cb20-166" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-2-2-2-2-1'</span>,</span>
<span id="cb20-167"><a href="#cb20-167" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-2-2-2-2-2'</span>,</span>
<span id="cb20-168"><a href="#cb20-168" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-1-1-1-1'</span>,</span>
<span id="cb20-169"><a href="#cb20-169" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-2-1-1-1'</span>,</span>
<span id="cb20-170"><a href="#cb20-170" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-2-2-1-1'</span>,</span>
<span id="cb20-171"><a href="#cb20-171" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-2-2-2-1'</span>,</span>
<span id="cb20-172"><a href="#cb20-172" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-2-2-2-2'</span>,</span>
<span id="cb20-173"><a href="#cb20-173" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-3-1-1-1'</span>,</span>
<span id="cb20-174"><a href="#cb20-174" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-3-2-1-1'</span>,</span>
<span id="cb20-175"><a href="#cb20-175" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-3-2-2-1'</span>,</span>
<span id="cb20-176"><a href="#cb20-176" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-3-2-2-2'</span>,</span>
<span id="cb20-177"><a href="#cb20-177" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-3-3-1-1'</span>,</span>
<span id="cb20-178"><a href="#cb20-178" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-3-3-2-1'</span>,</span>
<span id="cb20-179"><a href="#cb20-179" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-3-3-2-2'</span>,</span>
<span id="cb20-180"><a href="#cb20-180" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-3-3-3-1'</span>,</span>
<span id="cb20-181"><a href="#cb20-181" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-3-3-3-3-3-3-3-2'</span>,</span>
<span id="cb20-182"><a href="#cb20-182" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-1-1-1-1-1-1-1'</span>,</span>
<span id="cb20-183"><a href="#cb20-183" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-2-1-1-1-1-1-1'</span>,</span>
<span id="cb20-184"><a href="#cb20-184" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-2-2-1-1-1-1-1'</span>,</span>
<span id="cb20-185"><a href="#cb20-185" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-2-2-2-1-1-1-1'</span>,</span>
<span id="cb20-186"><a href="#cb20-186" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-2-2-2-2-1-1-1'</span>,</span>
<span id="cb20-187"><a href="#cb20-187" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-2-2-2-2-2-1-1'</span>,</span>
<span id="cb20-188"><a href="#cb20-188" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-2-2-2-2-2-2-1'</span>,</span>
<span id="cb20-189"><a href="#cb20-189" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-2-2-2-2-2-2-2'</span>,</span>
<span id="cb20-190"><a href="#cb20-190" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-1-1-1-1-1-1'</span>,</span>
<span id="cb20-191"><a href="#cb20-191" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-2-1-1-1-1-1'</span>,</span>
<span id="cb20-192"><a href="#cb20-192" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-2-2-1-1-1-1'</span>,</span>
<span id="cb20-193"><a href="#cb20-193" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-2-2-2-1-1-1'</span>,</span>
<span id="cb20-194"><a href="#cb20-194" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-2-2-2-2-1-1'</span>,</span>
<span id="cb20-195"><a href="#cb20-195" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-2-2-2-2-2-1'</span>,</span>
<span id="cb20-196"><a href="#cb20-196" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-2-2-2-2-2-2'</span>,</span>
<span id="cb20-197"><a href="#cb20-197" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-1-1-1-1-1'</span>,</span>
<span id="cb20-198"><a href="#cb20-198" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-2-1-1-1-1'</span>,</span>
<span id="cb20-199"><a href="#cb20-199" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-2-2-1-1-1'</span>,</span>
<span id="cb20-200"><a href="#cb20-200" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-2-2-2-1-1'</span>,</span>
<span id="cb20-201"><a href="#cb20-201" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-2-2-2-2-1'</span>,</span>
<span id="cb20-202"><a href="#cb20-202" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-2-2-2-2-2'</span>,</span>
<span id="cb20-203"><a href="#cb20-203" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-1-1-1-1'</span>,</span>
<span id="cb20-204"><a href="#cb20-204" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-2-1-1-1'</span>,</span>
<span id="cb20-205"><a href="#cb20-205" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-2-2-1-1'</span>,</span>
<span id="cb20-206"><a href="#cb20-206" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-2-2-2-1'</span>,</span>
<span id="cb20-207"><a href="#cb20-207" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-2-2-2-2'</span>,</span>
<span id="cb20-208"><a href="#cb20-208" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-3-1-1-1'</span>,</span>
<span id="cb20-209"><a href="#cb20-209" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-3-2-1-1'</span>,</span>
<span id="cb20-210"><a href="#cb20-210" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-3-2-2-1'</span>,</span>
<span id="cb20-211"><a href="#cb20-211" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-3-2-2-2'</span>,</span>
<span id="cb20-212"><a href="#cb20-212" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-3-3-1-1'</span>,</span>
<span id="cb20-213"><a href="#cb20-213" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-3-3-2-1'</span>,</span>
<span id="cb20-214"><a href="#cb20-214" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-3-3-2-2'</span>,</span>
<span id="cb20-215"><a href="#cb20-215" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-3-3-3-1'</span>,</span>
<span id="cb20-216"><a href="#cb20-216" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-3-3-3-3-3-3-2'</span>,</span>
<span id="cb20-217"><a href="#cb20-217" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-1-1-1-1-1-1'</span>,</span>
<span id="cb20-218"><a href="#cb20-218" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-2-1-1-1-1-1'</span>,</span>
<span id="cb20-219"><a href="#cb20-219" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-2-2-1-1-1-1'</span>,</span>
<span id="cb20-220"><a href="#cb20-220" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-2-2-2-1-1-1'</span>,</span>
<span id="cb20-221"><a href="#cb20-221" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-2-2-2-2-1-1'</span>,</span>
<span id="cb20-222"><a href="#cb20-222" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-2-2-2-2-2-1'</span>,</span>
<span id="cb20-223"><a href="#cb20-223" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-2-2-2-2-2-2'</span>,</span>
<span id="cb20-224"><a href="#cb20-224" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-1-1-1-1-1'</span>,</span>
<span id="cb20-225"><a href="#cb20-225" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-2-1-1-1-1'</span>,</span>
<span id="cb20-226"><a href="#cb20-226" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-2-2-1-1-1'</span>,</span>
<span id="cb20-227"><a href="#cb20-227" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-2-2-2-1-1'</span>,</span>
<span id="cb20-228"><a href="#cb20-228" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-2-2-2-2-1'</span>,</span>
<span id="cb20-229"><a href="#cb20-229" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-2-2-2-2-2'</span>,</span>
<span id="cb20-230"><a href="#cb20-230" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-1-1-1-1'</span>,</span>
<span id="cb20-231"><a href="#cb20-231" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-2-1-1-1'</span>,</span>
<span id="cb20-232"><a href="#cb20-232" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-2-2-1-1'</span>,</span>
<span id="cb20-233"><a href="#cb20-233" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-2-2-2-1'</span>,</span>
<span id="cb20-234"><a href="#cb20-234" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-2-2-2-2'</span>,</span>
<span id="cb20-235"><a href="#cb20-235" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-3-1-1-1'</span>,</span>
<span id="cb20-236"><a href="#cb20-236" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-3-2-1-1'</span>,</span>
<span id="cb20-237"><a href="#cb20-237" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-3-2-2-1'</span>,</span>
<span id="cb20-238"><a href="#cb20-238" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-3-2-2-2'</span>,</span>
<span id="cb20-239"><a href="#cb20-239" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-3-3-1-1'</span>,</span>
<span id="cb20-240"><a href="#cb20-240" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-3-3-2-1'</span>,</span>
<span id="cb20-241"><a href="#cb20-241" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-3-3-2-2'</span>,</span>
<span id="cb20-242"><a href="#cb20-242" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-3-3-3-1'</span>,</span>
<span id="cb20-243"><a href="#cb20-243" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-3-3-3-3-3-2'</span>,</span>
<span id="cb20-244"><a href="#cb20-244" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-1-1-1-1-1'</span>,</span>
<span id="cb20-245"><a href="#cb20-245" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-2-1-1-1-1'</span>,</span>
<span id="cb20-246"><a href="#cb20-246" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-2-2-1-1-1'</span>,</span>
<span id="cb20-247"><a href="#cb20-247" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-2-2-2-1-1'</span>,</span>
<span id="cb20-248"><a href="#cb20-248" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-2-2-2-2-1'</span>,</span>
<span id="cb20-249"><a href="#cb20-249" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-2-2-2-2-2'</span>,</span>
<span id="cb20-250"><a href="#cb20-250" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-1-1-1-1'</span>,</span>
<span id="cb20-251"><a href="#cb20-251" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-2-1-1-1'</span>,</span>
<span id="cb20-252"><a href="#cb20-252" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-2-2-1-1'</span>,</span>
<span id="cb20-253"><a href="#cb20-253" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-2-2-2-1'</span>,</span>
<span id="cb20-254"><a href="#cb20-254" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-2-2-2-2'</span>,</span>
<span id="cb20-255"><a href="#cb20-255" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-3-1-1-1'</span>,</span>
<span id="cb20-256"><a href="#cb20-256" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-3-2-1-1'</span>,</span>
<span id="cb20-257"><a href="#cb20-257" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-3-2-2-1'</span>,</span>
<span id="cb20-258"><a href="#cb20-258" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-3-2-2-2'</span>,</span>
<span id="cb20-259"><a href="#cb20-259" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-3-3-1-1'</span>,</span>
<span id="cb20-260"><a href="#cb20-260" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-3-3-2-1'</span>,</span>
<span id="cb20-261"><a href="#cb20-261" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-3-3-2-2'</span>,</span>
<span id="cb20-262"><a href="#cb20-262" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-3-3-3-1'</span>,</span>
<span id="cb20-263"><a href="#cb20-263" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-3-3-3-3-2'</span>,</span>
<span id="cb20-264"><a href="#cb20-264" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-1-1-1-1'</span>,</span>
<span id="cb20-265"><a href="#cb20-265" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-2-1-1-1'</span>,</span>
<span id="cb20-266"><a href="#cb20-266" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-2-2-1-1'</span>,</span>
<span id="cb20-267"><a href="#cb20-267" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-2-2-2-1'</span>,</span>
<span id="cb20-268"><a href="#cb20-268" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-2-2-2-2'</span>,</span>
<span id="cb20-269"><a href="#cb20-269" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-3-1-1-1'</span>,</span>
<span id="cb20-270"><a href="#cb20-270" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-3-2-1-1'</span>,</span>
<span id="cb20-271"><a href="#cb20-271" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-3-2-2-1'</span>,</span>
<span id="cb20-272"><a href="#cb20-272" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-3-2-2-2'</span>,</span>
<span id="cb20-273"><a href="#cb20-273" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-3-3-1-1'</span>,</span>
<span id="cb20-274"><a href="#cb20-274" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-3-3-2-1'</span>,</span>
<span id="cb20-275"><a href="#cb20-275" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-3-3-2-2'</span>,</span>
<span id="cb20-276"><a href="#cb20-276" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-3-3-3-1'</span>,</span>
<span id="cb20-277"><a href="#cb20-277" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-3-3-3-2'</span>,</span>
<span id="cb20-278"><a href="#cb20-278" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-1-1-1'</span>,</span>
<span id="cb20-279"><a href="#cb20-279" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-2-1-1'</span>,</span>
<span id="cb20-280"><a href="#cb20-280" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-2-2-1'</span>,</span>
<span id="cb20-281"><a href="#cb20-281" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-2-2-2'</span>,</span>
<span id="cb20-282"><a href="#cb20-282" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-3-1-1'</span>,</span>
<span id="cb20-283"><a href="#cb20-283" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-3-2-1'</span>,</span>
<span id="cb20-284"><a href="#cb20-284" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-3-2-2'</span>,</span>
<span id="cb20-285"><a href="#cb20-285" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-3-3-1'</span>,</span>
<span id="cb20-286"><a href="#cb20-286" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-3-3-2'</span>,</span>
<span id="cb20-287"><a href="#cb20-287" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-4-1-1'</span>,</span>
<span id="cb20-288"><a href="#cb20-288" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-4-2-1'</span>,</span>
<span id="cb20-289"><a href="#cb20-289" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-4-2-2'</span>,</span>
<span id="cb20-290"><a href="#cb20-290" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-4-3-1'</span>,</span>
<span id="cb20-291"><a href="#cb20-291" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-4-3-2'</span>,</span>
<span id="cb20-292"><a href="#cb20-292" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-4-4-1'</span>,</span>
<span id="cb20-293"><a href="#cb20-293" aria-hidden="true" tabindex="-1"></a>            <span class="st">'4-4-4-4-4-4-4-4-4-2'</span>]</span>
<span id="cb20-294"><a href="#cb20-294" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(<span class="bu">sorted</span>(profiles), expected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="profile-filters" class="level2">
<h2 class="anchored" data-anchor-id="profile-filters">Profile filters</h2>
<p>The profile filters work out which strategy profiles are relevant to the game in question. I already pass in two filters by default which keep only the strategy profiles which are relevant to the transition the algorithm is curently calculating the fixation probability for, and are possible given the <code>allowed_sectors</code> for the players.</p>
<p>Additional filters could be defined and passed in when desired (e.g.&nbsp;a filter to keep only strategy profiles which are unique to rearrangement)</p>
<p>Technical note: A similar effect could be achieved by having a sampling rule which returned 0 as the likelihood for irrelevant or impossible strategy profiles. However, it usually makes sense to keep these restrictions separate: profile filters can be reused for many possible games, but sampling rules may vary more often. There is also a slight performance advantage to having a profile filter, since it reduces the number of times the sampling rule must be called.</p>
<section id="profile-filter-methods" class="level5">
<h5 class="anchored" data-anchor-id="profile-filter-methods">Profile filter methods</h5>
<hr>
</section>
<section id="multi.._inner-4" class="level3">
<h3 class="anchored" data-anchor-id="multi.._inner-4">multi.<locals>._inner</locals></h3>
<blockquote class="blockquote">
<pre><code> multi.&lt;locals&gt;._inner (*args, **kwargs)</code></pre>
</blockquote>
<hr>
</section>
<section id="multi.._inner-5" class="level3">
<h3 class="anchored" data-anchor-id="multi.._inner-5">multi.<locals>._inner</locals></h3>
<blockquote class="blockquote">
<pre><code> multi.&lt;locals&gt;._inner (*args, **kwargs)</code></pre>
</blockquote>
<hr>
</section>
<section id="multi.._inner-6" class="level3">
<h3 class="anchored" data-anchor-id="multi.._inner-6">multi.<locals>._inner</locals></h3>
<blockquote class="blockquote">
<pre><code> multi.&lt;locals&gt;._inner (*args, **kwargs)</code></pre>
</blockquote>
<p>We also need a filter which yields the relevant profiles for each transition considered.</p>
<p>Given two states and their transition we first check that it is valid, and if we so we know the sector affected. Only that sector may choose different strategies, so the others are fixed.</p>
<p>Note that the recurrent states of the game describes each strategy employed by each sector. This is written in the same form as we write the strategy profile, “{strategy_code}-{strategy_code}-{strategy_code}” and uses the same codes.</p>
<p><strong>Note:</strong> Below, my filter only keeps strategies which are relevant to the two recurrent states relevant to the transition. If we need additional strategies, this filter will not be sufficient (this might be the case if we allow a social learning rule which explores more than one mutant strategy at a time)</p>
<hr>
</section>
<section id="multi.._inner-7" class="level3">
<h3 class="anchored" data-anchor-id="multi.._inner-7">multi.<locals>._inner</locals></h3>
<blockquote class="blockquote">
<pre><code> multi.&lt;locals&gt;._inner (*args, **kwargs)</code></pre>
</blockquote>
<p>I have also written a function for applying multiple filters.</p>
<hr>
<p><a href="https://github.com/PaoloBova/gh-pages-example/blob/main/gh_pages_example/model_utils.py#L317" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="apply_profile_filters" class="level3">
<h3 class="anchored" data-anchor-id="apply_profile_filters">apply_profile_filters</h3>
<blockquote class="blockquote">
<pre><code> apply_profile_filters (models)</code></pre>
</blockquote>
<p>Apply all profile filters listed in <code>profile_filters</code> in <code>models</code>.</p>
<section id="tests-for-profile_filter" class="level5">
<h5 class="anchored" data-anchor-id="tests-for-profile_filter">Tests for <a href="https://PaoloBova.github.io/gh-pages-example/model_utils.html#profile_filter"><code>profile_filter</code></a></h5>
</section>
<section id="test-1" class="level5">
<h5 class="anchored" data-anchor-id="test-1">Test 1</h5>
<p>Let’s test the <code>"allowed_sectors"</code> filter rule.</p>
<p>First I test a game with 3 players but only two sectors.<br>
Each player is fixed to a specific sector, but two players belong to the same sector.<br>
In this case the rule should filter to only those profiles where players use<br>
the strategies available to the sectors they can play as.</p>
<p>I then test a 3 player game with 3 sectors. Each player is fixed to a particular sector.</p>
</section>
<section id="test-2" class="level5">
<h5 class="anchored" data-anchor-id="test-2">Test 2</h5>
<p>Now, let’s test the <code>"relevant_to_transition"</code> filter rule.</p>
<p>First I test a game with 3 players but only two populations.<br>
In this case the rule should filter to only the relevant profiles where strategy 2 is missing.<br>
Recall that strategy 2 is the first strategy available to a player from sector 2.</p>
<p>I then test a larger game with 3 players and 3 sectors. The list is long, so I only check that the number of profiles kept is what we expect.</p>
</section>
<section id="test-3" class="level5">
<h5 class="anchored" data-anchor-id="test-3">Test 3</h5>
<p>I now test the <code>"allowed_sectors"</code> and “<code>relevant_to_transition</code>” rules when used together.<br>
The game is as before with 3 players and 3 sectors. Here, we can check that the list of profiles is as expected.</p>
<p>The order we apply these two filter rules should not matter.</p>
<p>We can use the <a href="https://PaoloBova.github.io/gh-pages-example/model_utils.html#apply_profile_filters"><code>apply_profile_filters</code></a> function to achieve the same result.</p>
<p>Let’s also check the eariler game with 2 sectors and 3 players.</p>
<p>Notice that in this game, transitions which affect the sector with multiple players require us to look at more profiles.</p>
</section>
</section>
<section id="an-additional-method-for-create_profiles-which-depends-on-profile_filter" class="level3">
<h3 class="anchored" data-anchor-id="an-additional-method-for-create_profiles-which-depends-on-profile_filter">An additional method for <a href="https://PaoloBova.github.io/gh-pages-example/model_utils.html#create_profiles"><code>create_profiles</code></a> which depends on <a href="https://PaoloBova.github.io/gh-pages-example/model_utils.html#profile_filter"><code>profile_filter</code></a></h3>
<hr>
</section>
<section id="multi.._inner-8" class="level3">
<h3 class="anchored" data-anchor-id="multi.._inner-8">multi.<locals>._inner</locals></h3>
<blockquote class="blockquote">
<pre><code> multi.&lt;locals&gt;._inner (*args, **kwargs)</code></pre>
</blockquote>
<p>Here is a quick test of the “allowed_sectors” method</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>allowed_sectors <span class="op">=</span> {<span class="st">"P1"</span>: [<span class="st">"S1"</span>],</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"P2"</span>: [<span class="st">"S1"</span>, <span class="st">"S2"</span>], }</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Third sector irrelevant given allowed sectors</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>sector_strategies <span class="op">=</span> {<span class="st">"S1"</span>: [<span class="st">"1"</span>, <span class="st">"2"</span>],</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"S2"</span>: [<span class="st">"3"</span>, <span class="st">"4"</span>],</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"S3"</span>: [<span class="st">"5"</span>, <span class="st">"6"</span>]}</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {<span class="st">"allowed_sectors"</span>: allowed_sectors,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">"sector_strategies"</span>: sector_strategies,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">"profiles_rule"</span>: <span class="st">"allowed_sectors"</span>}</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>profiles <span class="op">=</span> create_profiles(models)[<span class="st">'profiles'</span>]</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>expected <span class="op">=</span> [<span class="st">'1-1'</span>, <span class="st">"1-2"</span>, <span class="st">'2-1'</span>, <span class="st">'2-2'</span>, <span class="st">'3-1'</span>, <span class="st">'3-2'</span>, <span class="st">'4-1'</span>, <span class="st">'4-2'</span>]</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>fastcore.test.test_eq(<span class="bu">sorted</span>(profiles), expected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_3459/3464752654.py:24: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if (ind not in allowed_inds) and (str(ind) not in allowed_inds):</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>